'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _promise = require('babel-runtime/core-js/promise');

var _promise2 = _interopRequireDefault(_promise);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function join(child) {
  return new _promise2.default(function (_resolve, _reject) {
    function resolve(result) {
      child.removeAllListeners();
      _resolve(result);
    }
    function reject(error) {
      child.removeAllListeners();
      _reject(error);
    }
    child.on('exit', function (code, signal) {
      if (code != null && code !== 0) {
        var _error = new Error('process exited with code ' + code);
        var flowWorkaround = _error;
        flowWorkaround.code = code;
        flowWorkaround.signal = null;
        reject(_error);
      } else if (signal) {
        var _error2 = new Error('process exited with signal ' + signal);
        var _flowWorkaround = _error2;
        _flowWorkaround.code = null;
        _flowWorkaround.signal = signal;
        reject(_error2);
      } else resolve({ code: code, signal: signal });
    });
    child.on('error', reject);
  });
}

exports.default = join;